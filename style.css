/* Helper layout classes extracted from inline styles */
.flex-row { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
.rel { position: relative; }
.row.onecol { grid-template-columns: 1fr; }
.row.align-start { align-items: flex-start; }
.bar-between { justify-content: space-between; }
.m6 { margin: 6px 0 6px 0; }
.mt10-mb6 { margin: 10px 0 6px 0; }
.full-span { grid-column: 1 / -1; }
.ml-8 { margin-left: 8px; }
.ml-auto { margin-left: auto; }
.w-180 { width: 180px; }
.fw-700 { font-weight: 700; }
.pos-rel { position: relative; }
.flex-align-gap6 { display:flex; align-items:center; gap:6px; cursor:pointer; }
.m0 { margin: 0; }
.mb-8 { margin-bottom: 8px; }

#themeToggle { accent-color:#0ea5e9; }
#stockRow { display:none; }

/* Summary box (moved from inline) */
#summaryOut { white-space: pre-wrap; background: #fff; border:1px dashed var(--line); padding:12px; border-radius:12px; min-height:120px; }

/* Progress bar (moved from inline CSS) */
.progress{position:fixed;left:0;top:0;height:2px;background:#0ea5e9;z-index:99;width:0}
body.theme-dark .progress{background:#66c0f4}


/* extracted from ratewallet-2.html */
:root{
  --ink:#0b1220; --muted:#667085; --line:#e6e9ef;
  --mario-red:#e11d48; --sky:#38bdf8; --coin:#f59e0b; --green:#10b981;
  --paper:rgba(255,255,255,.9); --radius:18px;
  --shadow:0 14px 34px rgba(2,6,23,.12), 0 2px 8px rgba(2,6,23,.06);
  --bg1:#e0f2fe; --bg2:#f0f9ff; --bg3:#ffffff;
  --ripple: rgba(255,255,255,.35);
}
/* Steam 风格暗色主题（可切换） */
body.theme-dark{
  --ink:#e5e7eb; --muted:#9aa4b2; --line:#334155;
  --paper:rgba(17,24,39,.88);
  --shadow:0 20px 40px rgba(2,6,23,.45), 0 2px 8px rgba(2,6,23,.35);
  --bg1:#0b1220; --bg2:#0f172a; --bg3:#111827;
  --ripple: rgba(102,192,244,.35);
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;color:var(--ink);
  font:15.5px/1.6 -apple-system,BlinkMacSystemFont,"SF Pro Text","PingFang SC","Hiragino Sans GB",Segoe UI,Roboto,Helvetica,Arial}
html{scroll-behavior:smooth}
.bg{position:fixed;inset:0;z-index:-1;background:linear-gradient(180deg,var(--bg1) 0%, var(--bg2) 40%, var(--bg3) 100%)}
.bg::before{content:"";position:absolute;inset:-8% -8%;background-size:cover;background-position:center;filter:blur(16px) opacity(.25)}
.wrap{max-width:1080px;margin:0 auto;padding:22px 16px 120px}
header{display:flex;align-items:center;gap:14px;margin-bottom:14px}
.logo{width:42px;height:42px;border-radius:12px;background:
  radial-gradient(40% 40% at 30% 30%,#fff,transparent 70%),
  conic-gradient(from 200deg,var(--mario-red),#ef4444 30%,#fb7185 60%,var(--mario-red));
  box-shadow:0 10px 26px rgba(225,29,72,.28),0 2px 8px rgba(16,24,40,.08)}
h1{margin:0;font-weight:800;font-size:clamp(20px,2.6vw,28px);letter-spacing:.2px}
.sub{color:var(--muted);font-size:13px;margin-top:2px}

.card{background:var(--paper);backdrop-filter:saturate(150%) blur(10px);
  border:1px solid var(--line);border-radius:var(--radius);padding:16px;box-shadow:var(--shadow); margin-bottom: 14px;}
.grid2{display:grid;grid-template-columns:1.08fr .92fr;gap:14px}
.row{display:grid;grid-template-columns:150px 1fr;gap:10px;align-items:center;margin:10px 0}
label{color:#475569; font-weight: 600;}
input[type=text],input[type=number],select,textarea{
  width:100%;background:#fff;border:1px solid var(--line);border-radius:12px;color:var(--ink);
  padding:10px 12px;outline:none;transition:border .15s,box-shadow .15s}
input:focus,select:focus,textarea:focus{border-color:#bae6fd;box-shadow:0 0 0 5px rgba(56,189,248,.18)}
textarea{min-height:80px}

.chips{display:flex;flex-wrap:wrap;gap:10px}
.chip{border:2px solid #e2e8f0;border-radius:14px;padding:8px 14px;background:linear-gradient(180deg,#fff,#f8fafc);
  color:#0b1220;cursor:pointer;transition:transform var(--dur-quick) var(--ease), box-shadow var(--dur-quick) var(--ease)}
.chip:hover{transform:translateY(-1px)}
.chip.sel{background:linear-gradient(180deg,#fef3c7,#fde68a); border-color:#f59e0b; box-shadow:0 6px 14px rgba(245,158,11,.25)}

.pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;font-size:12px;border:1px solid var(--line);background:#fff}
.pill.ok{background:linear-gradient(180deg,#ecfeff,#dbeafe);border-color:#bfdbfe;color:#1e3a8a}
.pill.warn{background:linear-gradient(180deg,#fff7ed,#ffedd5);border-color:#fed7aa;color:#7c2d12}
.pill.err{background:linear-gradient(180deg,#fef2f2,#fee2e2);border-color:#fecaca;color:#7f1d1d}
.btn{display:inline-flex;align-items:center;gap:8px;justify-content:center;border:none;border-radius:14px;padding:12px 16px;color:#fff;
  background:linear-gradient(90deg,var(--mario-red) 0%, var(--coin) 100%);box-shadow:0 10px 24px rgba(225,29,72,.28);cursor:pointer;font-weight:800;letter-spacing:.2px;
  transition:transform var(--dur-quick) var(--ease), box-shadow var(--dur-quick) var(--ease), opacity var(--dur-quick) var(--ease)}
.btn:active{transform:translateY(1px)}
.btn:hover{transform:translateY(-1px); box-shadow:0 12px 28px rgba(225,29,72,.32)}
.btn.sky{background:linear-gradient(90deg,#0ea5e9, #22d3ee)}
.btn.ghost{background:#f3f5fb;color:#1f2a44;border:1px solid var(--line);box-shadow:none}
.btn[disabled]{opacity:.6; cursor:not-allowed; filter:saturate(.6)}
.btn.badge{font-size:13px;padding:8px 12px;border-radius:12px}
.dock{position:fixed;left:0;right:0;bottom:0;z-index:20;background:rgba(255,255,255,.86);
  backdrop-filter:saturate(150%) blur(10px);border-top:1px solid var(--line)}
.dock-inner{max-width:1080px;margin:0 auto;padding:12px 16px;display:flex;flex-wrap:wrap;align-items:center;gap:10px}
.log{margin-left:auto;color:var(--muted);font-size:12.5px}
#out{white-space:pre-wrap;background:#fff;border:1px dashed var(--line);padding:12px;border-radius:12px;min-height:160px}
.hints{display:flex;flex-wrap:wrap;gap:8px;margin:10px 0}
.hint{font-size:12px;color:#475569;padding:6px 10px;border:1px dashed #e2e8f0;border-radius:10px;background:#fff}
.subtle{font-size:12px;color:#64748b}
.titlebar{display:flex;align-items:center;gap:8px}
.titlebar .coin{filter:drop-shadow(0 6px 10px rgba(245,158,11,.35))}

/* 顶部锚点导航 */
.topnav{display:flex;gap:10px;margin-top:8px;flex-wrap:wrap}
.topnav a{font-size:12.5px;padding:6px 10px;border-radius:999px;border:1px solid var(--line);color:inherit;text-decoration:none;background:#fff}
body.theme-dark .topnav a{background:#0b1220;border-color:#334155;color:#e5e7eb}
.topnav a:hover{box-shadow:0 2px 8px rgba(2,6,23,.08)}
.topnav a.active{border-color:#0ea5e9;color:#0b1220;background:linear-gradient(180deg,#e0f2fe,#ffffff)}
body.theme-dark .topnav a.active{color:#e5e7eb;background:linear-gradient(180deg,#12263a,#0b1220);border-color:#0ea5e9}
.topnav a.active::after{content:"";display:block;height:2px;background:#0ea5e9;margin-top:4px;border-radius:2px;transition:width var(--dur-base) var(--ease);width:100%}
body.theme-dark .topnav a.active::after{background:#66c0f4}

/* 暗色主题下的细节对比度优化 */
body.theme-dark .card{border-color:#1f2937}
body.theme-dark .chip{background:linear-gradient(180deg,#0f172a,#111827);color:#e5e7eb;border-color:#334155}
body.theme-dark .chip.sel{background:linear-gradient(180deg,#164e63,#0e7490);border-color:#0ea5e9;box-shadow:0 10px 20px rgba(14,116,144,.35)}
body.theme-dark .btn.ghost{background:#0b1220;color:#e5e7eb;border-color:#334155}
body.theme-dark .hint{background:#0b1220;border-color:#334155;color:#cbd5e1}
body.theme-dark .toast{background:#0b1220;color:#e5e7eb}

@keyframes jump { 0%{transform:translateY(0)} 40%{transform:translateY(-8px)} 100%{transform:translateY(0)} }
.jump{animation:jump .28s ease-out}
.toast{position:fixed;left:50%;bottom:88px;transform:translateX(-50%) scale(.96);opacity:0;background:#111827;color:#fff;padding:10px 14px;border-radius:10px;z-index:60}
.toast.show{opacity:1;transform:translateX(-50%) scale(1);transition:all .18s ease}

.brick{height:10px;background:repeating-linear-gradient(90deg,#f59e0b 0 12px,#d97706 12px 24px);opacity:.2;border-radius:10px;margin:6px 0}

.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.35);z-index:80}
.modal .panel{background:#fff;border-radius:16px;max-width:460px;width:calc(100% - 40px);padding:18px;box-shadow:var(--shadow)}
.modal .panel .close{position:absolute;right:12px;top:10px;cursor:pointer;color:#64748b}
.modal.show{display:flex}
.modal .panel{transform:translateY(8px);opacity:0;transition:transform var(--dur-base) var(--ease), opacity var(--dur-base) var(--ease)}
.modal.show .panel{transform:translateY(0);opacity:1}

/* 按钮水波纹 */
.btn{position:relative;overflow:hidden}
.ripple{position:absolute;border-radius:50%;transform:scale(0);animation:ripple .5s ease-out;pointer-events:none;background:rgba(255,255,255,.35)}
/* 使用主题变量控制波纹颜色 */
.ripple{background:var(--ripple)}
@keyframes ripple{to{transform:scale(12);opacity:0}}

/* 预览更新动画 */
.updated{animation:flash .5s ease-out}
@keyframes flash{0%{box-shadow:0 0 0 0 rgba(14,165,233,.0)}50%{box-shadow:0 0 0 6px rgba(14,165,233,.15)}100%{box-shadow:0 0 0 0 rgba(14,165,233,.0)}}

/* 复制成功标记 */
.checkmark{display:inline-block;margin-left:6px;opacity:0;transform:translateY(-2px);transition:opacity .18s ease, transform .18s ease; font-size:12px; color:#065f46}
.checkmark.show{opacity:1;transform:translateY(0)}

/* 小型信息图标 */
.info{font-size:14px;color:#64748b;cursor:help}
body.theme-dark .info{color:#cbd5e1}
/* 轻量 tooltip（锚定到 info 图标后方） */
.tooltip{position:absolute; left:0; top:26px; background:#111827; color:#fff; font-size:12px; padding:8px 10px; border-radius:8px; box-shadow:0 6px 16px rgba(2,6,23,.25); opacity:0; transform:translateY(-4px); pointer-events:none; transition:opacity var(--dur-base) var(--ease), transform var(--dur-base) var(--ease)}
.tooltip.show{opacity:1; transform:translateY(0); pointer-events:auto}
body.theme-dark .tooltip{background:#0b1220}

/* ===== Samurai Intro Overlay (设计/动效代理落地) ===== */
.samurai-stage{position:fixed;inset:0;z-index:999;display:none;align-items:center;justify-content:center;overflow:hidden}
.samurai-stage.show{display:flex}
.samurai-bg{position:absolute;inset:-4%;background:radial-gradient(120% 120% at 80% 20%,#2a2f36 0,#11151a 40%,#0a0e12 75%);filter:saturate(80%) contrast(105%);transform:translate(var(--sx,0), var(--sy,0));transition:transform .08s linear}
.samurai-grain{position:absolute;inset:0;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" opacity="0.06"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="2"/></filter><rect width="100%" height="100%" filter="url(%23n)"/></svg>');mix-blend-mode:soft-light}
.samurai-layer{position:relative;text-align:center;opacity:0;transform:translateY(10px) scale(.98);transition:.7s cubic-bezier(.2,.8,.2,1)}
.samurai-layer.show{opacity:1;transform:none}
.samurai-title{font-size:min(64px,7vw);letter-spacing:.06em;color:#f1f3f5;text-shadow:0 2px 14px rgba(0,0,0,.4)}
.samurai-sub{margin-top:12px;color:#d7dadf;opacity:.9;animation:breath 1.2s ease-in-out infinite}
#samuraiTrail{position:absolute;inset:0;pointer-events:none;filter:blur(0.6px) contrast(120%) brightness(110%)}
.samurai-cursor{position:fixed;left:0;top:0;width:14px;height:14px;border-radius:2px;transform:rotate(45deg);background:linear-gradient(135deg,#fefefe,#c8c8c8);box-shadow:0 0 0 1px rgba(255,255,255,.25), 0 6px 18px rgba(0,0,0,.45);mix-blend-mode:screen;pointer-events:none;opacity:.95}
.samurai-skip{position:absolute;right:16px;bottom:16px;border:1px solid rgba(230,220,200,.35);background:transparent;color:#e7e2d6;border-radius:10px;padding:8px 12px;cursor:pointer}
.samurai-hidden{visibility:hidden}

/* Copy inline checkmark */
.checkmark{display:inline-flex;align-items:center;gap:6px;margin-left:8px;color:#16a34a;font-size:13px;opacity:0;transform:translateY(-2px);transition:opacity .2s ease, transform .2s ease}
.checkmark.show{opacity:1;transform:none}

/* 按钮加载态（用于导出等） */
.btn.loading{pointer-events:none}
.btn.loading::before{content:"";width:16px;height:16px;border:2px solid rgba(255,255,255,.6);border-top-color:transparent;border-radius:50%;display:inline-block;animation:spin .8s linear infinite;margin-right:6px}
@keyframes spin{to{transform:rotate(360deg)}}

@media (max-width:860px){
  .grid2{grid-template-columns:1fr}
  .row{grid-template-columns:1fr}
  .btn{padding:12px 14px}
  #out{min-height:220px}
}
